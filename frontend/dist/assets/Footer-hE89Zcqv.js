import{u as z}from"./index-DW3BOA4A.js";import{l as E,c as J,R as M}from"./api-D12zC24N.js";import{r as A,_ as I,f as O,m as B}from"./index-D85MJpsm.js";import{m as S,a as $,Z as C,ah as i,p as v,q as y,u as p,U as e,O as t,S as n,T,t as _,M as W,aA as D,aB as Z}from"./vue-DRvwLzXx.js";const G={key:0,class:"flex items-center space-x-2"},K={key:1,class:"flex items-center space-x-2"},Q={class:"dialog-footer"},X={class:"dialog-footer"},x="70px",H="370px",Y=S({__name:"Login",setup(w){const f=$(!1),a=z(),d=C({name:"",password:"",phone:"",email:""}),V=$(),o=C({name:"",password:"",checkpass:"",email:"",phone:""}),r=C({name:[{required:!0,message:"请输入名字",trigger:"blur"},{min:2,max:15,message:"长度为2到15个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码应不少于六位",trigger:"blur"}],checkpass:[{validator:(u,l,m)=>{l===""?(m(new Error("请再次输入密码")),console.log(u)):l!==o.password?m(new Error("密码不一致!")):m()},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"邮箱格式错误",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3456789]\d{9}$/,message:"手机号码格式不正确",trigger:"blur"}]}),h=async()=>{const u={name:d.name,password:d.password,phone:d.phone},l=await E(u);l.id>0?(a.id=l.id,a.name=l.username,a.atoken=l.atoken,a.rtoken=l.rtoken,a.logined=!0,a.dialogFormVisible=!1,d.name="",d.password="",A.push("/")):alert("用户名或密码错误,请重新输入")},b=()=>{a.id=0,a.name="",a.atoken="atoken",a.rtoken="rtoken",a.logined=!a.logined,A.push("/")},F=async()=>{const u=/^1[3456789]\d{9}$/;let l;if(u.test(d.phone)){const m={phone:d.phone};l=await J(m)}else return alert("请输入正确的手机号！"),!1;l&&l.code=="200"&&(alert(`已收到您的第${l.times}次重置密码申请，会尽快为您办理！`),a.dialogFormVisible=!1,d.phone="",d.password="")},k=async u=>{u&&await u.validate(l=>{l?U():alert("请完善注册信息!")})},U=async()=>{const u={name:o.name,password:o.password,email:o.email,phone:o.phone};(await M(u)).code==200?(alert("注册成功，请等待至多三天审核！"),o.name="",o.password="",o.checkpass="",o.email="",o.phone="",f.value=!1):alert("注册失败")};return(u,l)=>{const m=i("el-button"),j=i("router-link"),c=i("el-input"),g=i("el-form-item"),R=i("el-form"),q=i("el-dialog");return v(),y("div",null,[!p(a).logined||p(a).name.length==0?(v(),y("span",G,[e(m,{text:"",onClick:l[0]||(l[0]=s=>p(a).dialogFormVisible=!0)},{default:t(()=>[n("登录")]),_:1}),e(m,{text:"",onClick:l[1]||(l[1]=s=>f.value=!0)},{default:t(()=>[n("注册")]),_:1})])):(v(),y("span",K,[e(j,{to:"/user",tag:"el-link",type:"primary"},{default:t(()=>[n(T(p(a).name),1)]),_:1}),e(m,{text:"",onClick:b},{default:t(()=>[n("登出")]),_:1})])),e(q,{modelValue:p(a).dialogFormVisible,"onUpdate:modelValue":l[4]||(l[4]=s=>p(a).dialogFormVisible=s),width:H,center:!0,title:"登录"},{footer:t(()=>[_("span",Q,[e(m,{type:"primary",onClick:h},{default:t(()=>[n("登录")]),_:1}),e(m,{onClick:F},{default:t(()=>[n("忘记密码")]),_:1})])]),default:t(()=>[e(R,{model:d},{default:t(()=>[e(g,{label:"账号","label-width":x},{default:t(()=>[e(c,{modelValue:d.name,"onUpdate:modelValue":l[2]||(l[2]=s=>d.name=s),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(g,{label:"密码","label-width":x},{default:t(()=>[e(c,{type:"password",modelValue:d.password,"onUpdate:modelValue":l[3]||(l[3]=s=>d.password=s),autocomplete:"off","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(q,{modelValue:f.value,"onUpdate:modelValue":l[11]||(l[11]=s=>f.value=s),width:H,center:!0,title:"注册"},{footer:t(()=>[_("span",X,[e(m,{type:"primary",onClick:l[10]||(l[10]=s=>k(V.value))},{default:t(()=>[n("注册")]),_:1})])]),default:t(()=>[e(R,{model:o,ref_key:"ruleFormRef",ref:V,rules:r,"status-icon":""},{default:t(()=>[e(g,{label:"用户名",prop:"name","label-width":x},{default:t(()=>[e(c,{modelValue:o.name,"onUpdate:modelValue":l[5]||(l[5]=s=>o.name=s),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(g,{label:"密码",prop:"password","label-width":x},{default:t(()=>[e(c,{modelValue:o.password,"onUpdate:modelValue":l[6]||(l[6]=s=>o.password=s),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(g,{label:"确认密码",prop:"checkpass","label-width":x},{default:t(()=>[e(c,{modelValue:o.checkpass,"onUpdate:modelValue":l[7]||(l[7]=s=>o.checkpass=s),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(g,{label:"邮箱",prop:"email","label-width":x},{default:t(()=>[e(c,{modelValue:o.email,"onUpdate:modelValue":l[8]||(l[8]=s=>o.email=s),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(g,{label:"手机号",prop:"phone","label-width":x},{default:t(()=>[e(c,{modelValue:o.phone,"onUpdate:modelValue":l[9]||(l[9]=s=>o.phone=s),modelModifiers:{number:!0},autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}}),N=I(Y,[["__scopeId","data-v-5b81c7df"]]),P=w=>(D("data-v-4f7d0e41"),w=w(),Z(),w),ee={class:"flex justify-between items-center"},te=P(()=>_("a",{href:"/",class:"flex items-center"},[_("h2",{class:"text-2xl font-bold text-sky-600"},"鲸币")],-1)),le={class:"md:hidden flex items-center"},oe=P(()=>_("span",null,"编程语言",-1)),ae=P(()=>_("span",null,"框架",-1)),se=S({__name:"Header",setup(w){const f=$("1"),a=$(!1),d=(V,o)=>{console.log(V,o),V!=="Login"&&(a.value=!1)};return(V,o)=>{const L=i("router-link"),r=i("el-menu-item"),h=i("el-menu"),b=i("el-icon"),F=i("el-header"),k=i("el-sub-menu"),U=i("el-drawer"),u=i("el-container");return v(),W(u,null,{default:t(()=>[e(F,null,{default:t(()=>[_("div",ee,[te,e(h,{"default-active":f.value,class:"flex items-center space-x-4",mode:"horizontal",onSelect:d,ellipsis:!1},{default:t(()=>[e(r,{index:"1"},{default:t(()=>[e(L,{to:"/"},{default:t(()=>[n("首页")]),_:1})]),_:1}),e(r,{index:"2"},{default:t(()=>[n("课程")]),_:1}),e(r,{index:"3"},{default:t(()=>[n("资源")]),_:1}),e(r,{index:"4"},{default:t(()=>[e(N)]),_:1})]),_:1},8,["default-active"]),_("div",le,[e(b,{class:"menu-icon",onClick:o[0]||(o[0]=l=>a.value=!0)},{default:t(()=>[e(p(O))]),_:1})])])]),_:1}),e(U,{modelValue:a.value,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value=l),direction:"rtl",size:"80%"},{default:t(()=>[e(h,{"default-active":f.value,onSelect:d},{default:t(()=>[e(r,{index:"1"},{default:t(()=>[n("首页")]),_:1}),e(r,{index:"2"},{default:t(()=>[n("课程")]),_:1}),e(r,{index:"3"},{default:t(()=>[n("资源")]),_:1}),e(r,{index:"Login"},{default:t(()=>[e(N)]),_:1}),e(k,{index:"5"},{title:t(()=>[e(b,null,{default:t(()=>[e(p(B))]),_:1}),oe]),default:t(()=>[e(r,{index:"5-1"},{default:t(()=>[n("JavaScript")]),_:1}),e(r,{index:"5-2"},{default:t(()=>[n("Python")]),_:1}),e(r,{index:"5-3"},{default:t(()=>[n("Java")]),_:1})]),_:1}),e(k,{index:"6"},{title:t(()=>[e(b,null,{default:t(()=>[e(p(B))]),_:1}),ae]),default:t(()=>[e(r,{index:"6-1"},{default:t(()=>[n("Vue.js")]),_:1}),e(r,{index:"6-2"},{default:t(()=>[n("React")]),_:1}),e(r,{index:"6-3"},{default:t(()=>[n("Angular")]),_:1})]),_:1})]),_:1},8,["default-active"])]),_:1},8,["modelValue"])]),_:1})}}}),pe=I(se,[["__scopeId","data-v-4f7d0e41"]]),ne={class:"centered-text"},de=S({__name:"Footer",setup(w){return(f,a)=>(v(),y("div",ne," 鲸币 @ 2024 "))}}),fe=I(de,[["__scopeId","data-v-4ce3d8b3"]]);export{fe as F,pe as H};
